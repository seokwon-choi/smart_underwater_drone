## AI기반 수중드론을 활용한 선박 청소 시스템
![one](https://user-images.githubusercontent.com/85105917/132091960-72a2cd6a-821c-4bb1-888a-c3ed10f1050f.JPG)

### 1. 담당 업무 : Keil uVision5 환경에서 수중드론 제어, CNN(MobileNetV2모델)을 활용한 이미지 분석
### 2. 개발 기획 (WBS를 작성해 프로젝트 일정을 계획)
![image](https://user-images.githubusercontent.com/85105917/132093714-218a252b-e344-4698-9dc2-c2d3a2e0de5d.png)
#### 2-1. 울산항만청 관계자와의 인터뷰를 바탕으로 서비스 구성도 설계 : 현재 시스템 분석과 요구사항 파악
1. 현재 시스템은 200m이상 선체 청소 시 잠수부 6~7명이 투입되어 1주일 정도 작업한다는 답변을 받음
2. 현대 상선에서 수중드론을 이용하여 선체 청소를 하는 사례가 있지만 기술이 완벽하지 않다는답변을 받음
3. 잠수부를 도입하여 청소하는 것 보다 비용 절감이 30~40%정도 라고  예상한다는 답변을 받음
4. 수중드론으로 촬영한 영상을 분석해 주어 청소 여부를 알려준다면 더 유용할 것이라는 답변을 받음
![image](https://user-images.githubusercontent.com/85105917/132093817-8ef3eb30-1949-4175-a90c-63767bfc6993.png)
![image](https://user-images.githubusercontent.com/85105917/132093898-92dc1d6b-4b54-427e-9623-d5650c156eae.png)
#### 2-2 서비스 흐름도를 바탕으로 메뉴 구성도 설계
![image](https://user-images.githubusercontent.com/85105917/132094306-08be816c-f5d9-4596-bfff-0ce828771c6f.png)
#### 2-3 기능 설계도를 설계하여 시스템 분석 및 설계
![image](https://user-images.githubusercontent.com/85105917/132094379-4ab60644-0866-4fd8-a0ba-5b323df3d151.png)
![image](https://user-images.githubusercontent.com/85105917/132094395-7eb02b6c-8468-411b-b597-f29e0b59d234.png)
### 3. 프로젝트 내용 : 수중드론 개발, AI 이미지 분석 프로그램, 청소 요청 및 이미지 분석 결과 전달 APP(필자가 개발에 참여한 부분이 아니므로 자세한 설명 생략)
#### 3-1. 청소요청 앱 개발 : 선박에서 항만청 관리자에게 앱으로 청소를 요청
![image](https://user-images.githubusercontent.com/85105917/132098586-2517fff5-3835-40c1-aca7-a4dc5fe666c1.png)
irebase의 cloud message 기능과 json data 전송으로 해당 기기의 토큰을 받아서 관리자와 조종사간 청소 요청 메시지를 전송한다.
#### 3-2. 수중드론 개발 : 수중드론으로 선체 바닥을 촬영한다.
![image](https://user-images.githubusercontent.com/85105917/132095672-94b08a42-1dff-43eb-a708-44e1488d087a.png)
1. Cortex m0를 사용하여 조종기의 신호에 따라 수중드론 동작 제어를 설정한다. ex) 속도 조절, 방향 제어 등
2. BLDC모터는 ESC를 사용하기 때문에 Calibration을 해주어야한다.
3. Calibration 방법은 최대 DUTY와 최소 DUTY를 입력시켜 진행한다. 본 프로젝트는 60%, 20%를 부여하였다.
4. 60%와 20%의 중간인 40%가 되면 BLDC모터는 정지한다. 40%이하이면 역방향으로 40%에서 멀어질수록 속도가 빨라진다.
5. 반대로 40%보다 크면 정방향이고 속도 조절은 역방향과 같다.
6. 본 프로젝트는 추진 모터 2개로 직진, 후진, 좌회전, 우회전을 제어하였고 4개의 모터로 상승, 하강, 정지비행을 제어하였다.
#### 3-3. AI 이미지 분석 프로그램 : 촬영한 사진을 분석하여 선체 바닥의 따개비 유무를 파악한다.
![image](https://user-images.githubusercontent.com/85105917/132096320-e67d0658-bda3-458d-bc99-d000cb9a9ff6.png)
1. imageNet(1400만개 이미지)으로 pretrained된 모델을 사용하여 전이학습을 진행한다.
2. 딥러닝(지도 학습)모델 MobileNetV2모델을 사용한다.
3. 깨끗한 이미지, 따개비가 붙은 이미지 2개로 나누어 labeling을 진행한다.
4. 신경망이 복잡하므로 dropout을 사용해 효율성을 증가시킨다.
5. 정확도를 올리기 위하여 2번 학습시킨다. 
6. 첫번째는 convolutional base를 모두 freeze하고 classifier만 재학습시키는 Top Layer Finetuning을 진행한다.
7. 두번째는 100번째 계층 이후로는 unfreezing을 하여 finetuning을 진행한다.
8. test data와 train data는 용량이 큼으로 github에는 올리지 못함
9. 데이터 이미지가 깨끗한 사진과 따개비가 붙은 사진이다 보니 사진 분류의 정확도가 높아 정확도가 100%가 나옴
![정확도](https://user-images.githubusercontent.com/85105917/132097979-a8b99d00-8450-4365-938a-8ec9fd6d032e.JPG)
#### 3-4. 이미지 분석 결과 전달 앱 : AI 이미지 분석 결과를 앱으로 전송받아 관리자와 드론 조종사가 확인할 수 있다.
![image](https://user-images.githubusercontent.com/85105917/132098617-e8754c44-7163-4ac2-9ae7-92752c7bda36.png)

선체 관리 어플리케이션 제작으로 현재 선체 상태를 알려주고 딥러닝 기반 선체 분석 프로그램을 클라우드로 연동시켜 모바일에서도 프로그램 실행이 가능하다. Colab에서 분석된 데이터를 바탕으로 푸시 알림을 전송한다. 청소 요청 앱은 Android Studio로 구현하였으며 알림은 FCM 기능을 이용하여 해당하는 api key와 token을 통해 notification을 제공한다.
### 4. 프로젝트 결과의 기대효과
1. PC와의 통신으로 미리 위치 파악을 통한 잠수부 투입으로 탐색 시간 감소 및 인건비 절감 효과가 있음
2. 선체 청소 알림시스템으로 주기적인 선박 관리에 도움을 줄 수 있음
3. 기존의 선박 관리는 잠수부가 직접 하였으나 수중드론 도입으로 잠수부의 위험 부담이 줄어듦
4. 선박 노후화 관리 및 인명 사고 예방에 효과적인 역할을 할 것으로 기대됨
5. 비용적인 측면에서도 한 번 제작한 수중드론은 반영구적으로 사용 가능함
### 5.프로젝트 결과의 추가 활용분야
1. 선체 하부 관리뿐만 아니라 잔교식 부두의 파이프 관리 및 보수에 사용 가능함
2. 갯녹음 방지를 위한 바다 숲 사후 관리에 모니터링 및 작업으로 적용 가능
3. 바다 쓰레기를 청소하는 수중 드론으로 적용 가능
4. 해양 사고로 인한 실종자 수색 활동 지원 가능
### 6. 프로젝트를 진행하면서 어려웠던 점
1. 처음 프로젝트를 진행하여 프로젝트 관리 방법(재료 구매, 일정 관리 등)에 미숙해 중간에 지연되는  시간이 많아서 일정대로 프로젝트를 진행하지 못해 마지막에 몰아서 한 경우가 있음
2. 처음 접해본 ARM Cortex m0를 사용하여 수중드론을 제어하였기 때문에 초기 스터디에 어려움이 있어 시간을 많이 투자했고 AI에 대한 이해도를 높이기 위해 AI캠프를 참가하여 역량을 늘리는데 시간을 많이 투자하였음
### 7. 느낀 점
1. BLDC모터는 ESC와 결합하여 pwm제어를 통해 구동 된다는 점을 배움
2. CNN(MobileNetV2모델)을 활용한 이미지 이진 분류를 위해 다량의 데이터 확보와 오픈소스 활용의 중요성을 배움
3. 프로젝트 진행 시, 팀원들과의 의사소통 및 주기적인 회의가 프로젝트 완성에 중요하다는 것을 느낌
4. 프로젝트 관리 방법(사전 조사, 일정 관리 등)의 중요성을 깨닫고 이를 배워야겠다고 느낌
5. AI, IOT분야에 대한 폭 넓은 이해를 위해 해당 분야에 대한 추가 프로젝트를 해야겠다고 느낌








